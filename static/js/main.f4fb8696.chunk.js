(this.webpackJsonpcodial=this.webpackJsonpcodial||[]).push([[0],{34:function(e,t,a){e.exports=a(46)},39:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(18),c=a.n(s),o=(a(39),a(8)),i=a(4),l=a(5),u=a(7),m=a(6),d=a(2),p=a(9),h="http://codeial.com:8000/api/v2",f=function(){return"".concat(h,"/users/login")},v=function(){return"".concat(h,"/users/signup")},E=function(){return"".concat(h,"/users/edit")},g=function(e){return"".concat(h,"/users/").concat(e)},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"".concat(h,"/posts?page=").concat(e,"&limit=").concat(t)},N=function(){return"".concat(h,"/friendship/fetch_user_friends")},w=function(e){return"".concat(h,"/friendship/create_friendship?user_id=").concat(e)},O=function(e){return"".concat(h,"/friendship/remove_friendship?user_id=").concat(e)};function S(){return function(e){var t=b();fetch(t).then((function(e){return e.json()})).then((function(t){console.log("data",t),e({type:"UPDATE_POSTS",posts:t.data.posts})}))}}var C=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.posts;return r.a.createElement("div",{className:"posts-list"},e.map((function(e){return r.a.createElement("div",{className:"post-wrapper",key:e._id},r.a.createElement("div",{className:"post-header"},r.a.createElement("div",{className:"post-avatar"},r.a.createElement(p.b,{to:"/user/".concat(e.user._id)},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/3237/3237472.svg",alt:"user-pic"})),r.a.createElement("div",null,r.a.createElement("span",{className:"post-author"},e.user.name),r.a.createElement("span",{className:"post-time"},"a minute ago"))),r.a.createElement("div",{className:"post-content"},e.content),r.a.createElement("div",{className:"post-actions"},r.a.createElement("div",{className:"post-like"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/1076/1076984.svg",alt:"likes-icon"}),r.a.createElement("span",null,e.likes.length)),r.a.createElement("div",{className:"post-comments-icon"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/831/831264.svg",alt:"comments-icon"}),r.a.createElement("span",null,e.comments.length))),r.a.createElement("div",{className:"post-comment-box"},r.a.createElement("input",{placeholder:"Start typing a comment"})),r.a.createElement("div",{className:"post-comments-list"},r.a.createElement("div",{className:"post-comments-item"},r.a.createElement("div",{className:"post-comment-header"},r.a.createElement("span",{className:"post-comment-author"},"Bill"),r.a.createElement("span",{className:"post-comment-time"},"a minute ago"),r.a.createElement("span",{className:"post-comment-likes"},"22")),r.a.createElement("div",{className:"post-comment-content"},"Random comment")))))})))}}]),a}(n.Component);function j(e){var t=[];for(var a in e){var n=encodeURIComponent(a),r=encodeURIComponent(e[a]);t.push(n+"="+r)}return t.join("&")}function _(){return localStorage.getItem("token")}var I=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleLogout=function(){localStorage.removeItem("token"),e.props.dispatch({type:"LOGOUT"})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.auth;return r.a.createElement("nav",{className:"nav"},r.a.createElement("div",{className:"left-div"},r.a.createElement(p.b,{to:"/"},r.a.createElement("img",{className:"logo-icons",src:"https://www.flaticon.com/svg/static/icons/svg/3437/3437338.svg",alt:"logo"}),r.a.createElement("div",{className:"logo"},"Codial"))),r.a.createElement("div",{className:"search-container"},r.a.createElement("input",{placeholder:"Search"}),r.a.createElement("div",{className:"search-results"},r.a.createElement("ul",null,r.a.createElement("li",{className:"search-results-row"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/3237/3237447.svg",alt:"User Avatar"}),r.a.createElement("span",null,"Shivani J")),r.a.createElement("li",{className:"search-results-row"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/3237/3237447.svg",alt:"User Avatar"}),r.a.createElement("span",null,"Shivani J"))))),r.a.createElement("div",{className:"right-nav"},e.isLoggedIn&&r.a.createElement("div",{className:"user"},r.a.createElement(p.b,{to:"/settings"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/3237/3237447.svg",alt:"User Avatar",id:"user-dp"})),r.a.createElement("span",null,e.user.name)),r.a.createElement("div",{className:"nav-links"},r.a.createElement("ul",null,!e.isLoggedIn&&r.a.createElement("li",null,r.a.createElement(p.b,{to:"/login"},"Login")),e.isLoggedIn&&r.a.createElement("li",{onClick:this.handleLogout},"Logout"),!e.isLoggedIn&&r.a.createElement("li",null,r.a.createElement(p.b,{to:"/signup"},"Register"))))))}}]),a}(r.a.Component);var y=Object(o.b)((function(e){return{auth:e.auth}}))(I),T=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.posts,a=e.friends,n=e.isLoggedIn;return r.a.createElement("div",{className:"home"},r.a.createElement(C,{posts:t}),n&&r.a.createElement(J,{friends:a}))}}]),a}(r.a.Component);var P=function(){return r.a.createElement("div",null,r.a.createElement("h1",{className:"not-found"},"OOPS! NOTHING FOUND"))},L=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleEmailChange=function(e){n.setState({email:e.target.value})},n.handlePasswordChange=function(e){n.setState({password:e.target.value})},n.handleFormSubmit=function(e){e.preventDefault(),console.log(n.state);var t=n.state,a=t.email,r=t.password;a&&r&&n.props.dispatch(function(e,t){return function(a){a({type:"LOGIN_START"});var n=f();fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:j({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){if(console.log("EDit data",e),e.success)return localStorage.setItem("token",e.data.token),void a((t=e.data.user,{type:"LOGIN_SUCCESS",user:t}));var t;a({type:"LOGIN_FAILED",error:e.message})}))}}(a,r))},n.state={email:"",password:""},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"CLEAR_AUTH_STATE"})}},{key:"render",value:function(){var e=this.props.auth,t=e.error,a=e.inProgress,n=e.isLoggedIn,s=(this.props.location.state||{from:{pathname:"/"}}).from;return n?r.a.createElement(d.a,{to:s}):r.a.createElement("form",{className:"login-form"},r.a.createElement("span",{className:"login-signup-header"},"Login"),t&&r.a.createElement("div",{className:"alert error-dailog"},t),r.a.createElement("div",{className:"field"},r.a.createElement("input",{type:"email",placeholder:"Email",required:!0,onChange:this.handleEmailChange})),r.a.createElement("div",{className:"field"},r.a.createElement("input",{type:"password",placeholder:"Password",required:!0,onChange:this.handlePasswordChange})),r.a.createElement("div",{className:"field"},a?r.a.createElement("button",{onClick:this.handleFormSubmit,disabled:a},"Logging in......"):r.a.createElement("button",{onClick:this.handleFormSubmit,disabled:a},"Login")))}}]),a}(r.a.Component);var U=Object(o.b)((function(e){return{auth:e.auth}}))(L),A=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleNameChange=function(e){n.setState({username:e.target.value})},n.handleEmailChange=function(e){n.setState({email:e.target.value})},n.handlePasswordChange=function(e){n.setState({password:e.target.value})},n.handleConfirmPasswordChange=function(e){n.setState({confirmPassword:e.target.value})},n.handleFormSubmit=function(e){e.preventDefault(),console.log(n.state);var t=n.state,a=t.username,r=t.email,s=t.password,c=t.confirmPassword;a&&r&&s&&c&&(n.props.dispatch({type:"SIGNUP_START"}),n.props.dispatch(function(e,t,a,n){return function(r){r({type:"SIGNUP_START"});var s=v();fetch(s,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:j({name:e,email:t,password:a,confirm_password:n})}).then((function(e){return e.json()})).then((function(e){if(console.log("data",e),e.success)return localStorage.setItem("token",e.data.token),void r((t=e.data.user,{type:"SIGNUP_SUCCESS",user:t}));var t;r({type:"SIGNUP_FAILED",error:e.message})}))}}(a,r,s,c)))},n.state={username:"",email:"",password:"",confirmPassword:""},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"CLEAR_AUTH_STATE"})}},{key:"render",value:function(){var e=this.props.auth,t=e.error,a=e.inProgress;return e.isLoggedIn?r.a.createElement(d.a,{to:"/"}):r.a.createElement("form",{className:"login-form"},r.a.createElement("span",{className:"login-signup-header"},"Signup"),t&&r.a.createElement("div",{className:"alert error-dailog"},t),r.a.createElement("div",{className:"field"},r.a.createElement("input",{type:"text",placeholder:"username",required:!0,onChange:this.handleNameChange})),r.a.createElement("div",{className:"field"},r.a.createElement("input",{type:"email",placeholder:"Email",required:!0,onChange:this.handleEmailChange})),r.a.createElement("div",{className:"field"},r.a.createElement("input",{type:"password",placeholder:"Password",required:!0,onChange:this.handlePasswordChange})),r.a.createElement("div",{className:"field"},r.a.createElement("input",{type:"password",placeholder:"Confirm Password",required:!0,onChange:this.handleConfirmPasswordChange})),r.a.createElement("div",{className:"field"},a?r.a.createElement("button",{onClick:this.handleFormSubmit,disabled:a},"Signing up......"):r.a.createElement("button",{onClick:this.handleFormSubmit,disabled:a},"Signup")))}}]),a}(r.a.Component);var k=Object(o.b)((function(e){return{auth:e.auth}}))(A),R=a(20),F=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleChange=function(e,t){n.setState(Object(R.a)({},e,t)),n.props.dispatch({type:"CLEAR_AUTH_STATE"})},n.handleSave=function(){var e=n.state,t=e.password,a=e.confirmPassword,r=e.name,s=n.props.auth.user;n.props.dispatch(function(e,t,a,n){return function(r){var s=E();fetch(s,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(_())},body:j({name:e,password:t,confirm_password:a,id:n})}).then((function(e){return e.json()})).then((function(e){if(console.log("data",e),e.success)return r({type:"EDIT_USER_SUCCESS",user:e.data.user}),void(e.data.token&&localStorage.setItem("token",e.data.token));r({type:"EDIT_USER_FAIL",error:e.message})}))}}(r,t,a,s._id))},n.state={name:"",password:"",confirmPassword:"",editMode:!1},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.props.dispatch({type:"CLEAR_AUTH_STATE"})}},{key:"render",value:function(){var e=this,t=this.props.auth,a=t.user,n=t.error,s=this.state.editMode;return r.a.createElement("div",{className:"settings"},r.a.createElement("div",{className:"img-container"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/163/163802.svg",alt:"user-dp"})),n&&r.a.createElement("div",{className:"alert error-dailog"}," ",n," "),!1===n&&r.a.createElement("div",{className:"alert success-dailog"}," Profile Successfully Edited "),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field-label"},"Email"),r.a.createElement("div",{className:"field-value"}," ",a.email," ")),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field-label"},"Name"),s?r.a.createElement("input",{type:"text",onChange:function(t){return e.handleChange("name",t.target.value)},value:this.state.name}):r.a.createElement("div",{className:"field-value"}," ",a.name," ")),s&&r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field-label"},"New Password"),r.a.createElement("input",{type:"password",onChange:function(t){return e.handleChange("password",t.target.value)},value:this.state.password})),s&&r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field-label"},"Confirm Password"),r.a.createElement("input",{type:"password",onChange:function(t){return e.handleChange("confirmPassword",t.target.value)},value:this.state.confirmPassword})),r.a.createElement("div",{className:"btn-grp"},s?r.a.createElement("button",{className:"button save-btn",onClick:function(){return e.handleSave()}},"Save"):r.a.createElement("button",{className:"button edit-btn",onClick:function(){return e.handleChange("editMode",!0)}},"Edit Profile"),s&&r.a.createElement("div",{className:"go-back",onClick:function(){return e.handleChange("editMode",!1)}}," Go Back ")))}}]),a}(n.Component);var D=Object(o.b)((function(e){return{auth:e.auth}}))(F),x=a(17),G=a.n(x),M=a(27);function H(e){return function(t){var a=N(e);fetch(a,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(_())}}).then((function(e){return e.json()})).then((function(e){console.log("data friends",e.data.friends),t({type:"FETCH_USER_FRIEND",friends:e.data.friends})}))}}function B(e){return{type:"REMOVE_FRIEND",userId:e}}var q=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleAddFriend=Object(M.a)(G.a.mark((function e(){var t,a,r,s,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params.userId,a=w(t),r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(_())}},e.next=5,fetch(a,r);case 5:return s=e.sent,e.next=8,s.json();case 8:(c=e.sent).success?(n.setState({success:!0,successMessage:"Friend added successfully"}),n.props.dispatch({type:"ADD_FRIEND",friend:c.data.friendship})):n.setState({success:null,error:c.message});case 10:case"end":return e.stop()}}),e)}))),n.handleRemoveFriend=Object(M.a)(G.a.mark((function e(){var t,a,r,s,c,o;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match,a=t.params.userId,r=O(a),s={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(_())}},e.next=6,fetch(r,s);case 6:return c=e.sent,e.next=9,c.json();case 9:(o=e.sent).success?(console.log("Data for removal userID : ",a),n.setState({success:!0,successMessage:"Friend Removed successfully"}),n.props.dispatch(B(a))):n.setState({success:null,error:o.message});case 11:case"end":return e.stop()}}),e)}))),n.state={success:null,error:null,successMessage:null},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e,t=this.props.match;t.params.userId&&this.props.dispatch((e=t.params.userId,function(t){t({type:"FETCH_USER_PROFILE_START"});var a=g(e);fetch(a,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(_())}}).then((function(e){return e.json()})).then((function(e){e.success?t({type:"USER_PROFILE_SUCCESS",user:e.data.user}):t({type:"USER_PROFILE_FAIL",error:e.message})}))}))}},{key:"checkUserFriend",value:function(){var e=this.props,t=e.match,a=e.friends,n=t.params.userId;return-1!==a.map((function(e){return e.to_user._id})).indexOf(n)}},{key:"render",value:function(){var e=this.props,t=e.match.params,a=e.profile;console.log("this.props",t);var n=a.user,s=this.state,c=s.success,o=s.successMessage,i=s.error;if(a.inProgress)return r.a.createElement("h1",null,"Loading....");var l=this.checkUserFriend();return r.a.createElement("div",{className:"settings"},r.a.createElement("div",{className:"img-container"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/163/163802.svg",alt:"user-dp"})),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field-label"},"Email"),r.a.createElement("div",{className:"field-value"}," ",n.email," ")),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field-label"},"Name"),r.a.createElement("div",{className:"field-value"}," ",n.name," ")),l?r.a.createElement("button",{className:"save-btn",onClick:this.handleRemoveFriend},"Remove Friend"):r.a.createElement("button",{className:"save-btn",onClick:this.handleAddFriend},"Add Friend"),c&&r.a.createElement("div",{className:"alert success-dailog"},o," "),i&&r.a.createElement("div",{className:"alert error-dailog"},i," "))}}]),a}(r.a.Component);var z=Object(o.b)((function(e){return{profile:e.profile,friends:e.friends}}))(q),J=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.friends;return r.a.createElement("div",{className:"friends-list"},r.a.createElement("div",{className:"header"},"Friends"),e&&0===e.length&&r.a.createElement("div",{className:"no-friends"},"No friends found"),e&&e.map((function(e){return r.a.createElement(p.b,{className:"friends-item",to:"/user/".concat(e.to_user._id)},r.a.createElement("span",{className:"friends-img"},r.a.createElement("img",{src:"https://www.flaticon.com/svg/static/icons/svg/3187/3187459.svg",alt:"Friends image"})),r.a.createElement("span",{className:"friends-name"}," ",e.to_user.name," "))})))}}]),a}(r.a.Component),W=a(30),V=function(e){var t=e.isLoggedIn,a=e.path,n=e.component;return r.a.createElement(d.b,{path:a,render:function(e){return t?r.a.createElement(n,e):r.a.createElement(d.a,{to:{pathname:"/login",state:{from:e.location}}})}})},K=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.dispatch(S());var e=_();if(e){var t=Object(W.a)(e);console.log("user",t),this.props.dispatch(function(e){return{type:"AUTHENTICATE_USER",user:e}}({email:t.email,_id:t._id,name:t.name})),this.props.dispatch(H())}}},{key:"render",value:function(){var e=this.props,t=e.posts,a=e.auth,n=e.friends;return r.a.createElement(p.a,null,r.a.createElement("div",null,r.a.createElement(y,null),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(T,Object.assign({},e,{posts:t,friends:n,isLoggedIn:a.isLoggedIn}))}}),r.a.createElement(d.b,{path:"/login",component:U}),r.a.createElement(d.b,{path:"/signup",component:k}),r.a.createElement(V,{path:"/settings",component:D,isLoggedIn:a.isLoggedIn}),r.a.createElement(V,{path:"/user/:userId",component:z,isLoggedIn:a.isLoggedIn}),r.a.createElement(d.b,{component:P}))))}}]),a}(r.a.Component);var Q=Object(o.b)((function(e){return{posts:e.posts,auth:e.auth,friends:e.friends}}))(K),X=a(13),Y=a(31),Z=a(32),$=a.n(Z);var ee=a(1),te={user:{},error:null,isLoggedIn:!1,inProgress:!1};var ae={user:{},error:null,success:null,inProgress:!1};var ne=a(33),re=[];var se=Object(X.c)({posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_POSTS":return t.posts;default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLEAR_AUTH_STATE":return Object(ee.a)(Object(ee.a)({},e),{},{error:null});case"LOGIN_START":case"SIGNUP_START":return Object(ee.a)(Object(ee.a)({},e),{},{inProgress:!0});case"LOGIN_SUCCESS":case"SIGNUP_SUCCESS":return Object(ee.a)(Object(ee.a)({},e),{},{user:t.user,isLoggedIn:!0,inProgress:!1,error:null});case"LOGIN_FAILED":case"SIGNUP_FAILED":return Object(ee.a)(Object(ee.a)({},e),{},{inProgress:!1,error:t.error});case"AUTHENTICATE_USER":return Object(ee.a)(Object(ee.a)({},e),{},{user:t.user,isLoggedIn:!0});case"LOGOUT":return Object(ee.a)(Object(ee.a)({},e),{},{user:{},isLoggedIn:!1});case"EDIT_USER_SUCCESS":return Object(ee.a)(Object(ee.a)({},e),{},{user:t.user,error:!1});case"EDIT_USER_FAIL":return Object(ee.a)(Object(ee.a)({},e),{},{error:t.error});default:return e}},profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_PROFILE_SUCCESS":return Object(ee.a)(Object(ee.a)({},e),{},{user:t.user,inProgress:!1,success:!0});case"USER_PROFILE_FAIL":return Object(ee.a)(Object(ee.a)({},e),{},{error:t.error,inProgress:!1});case"FETCH_USER_PROFILE_START":return Object(ee.a)(Object(ee.a)({},e),{},{inProgress:!0});default:return e}},friends:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_USER_FRIEND":return Object(ne.a)(t.friends);case"ADD_FRIEND":return e.concat(t.friend);case"REMOVE_FRIEND":return e.filter((function(e){return e.to_user._id!==t.userId}));default:return e}}});var ce=Object(X.d)(se,Object(X.a)(Y.a,$.a));console.log("store : ",ce.getState()),c.a.render(r.a.createElement(o.a,{store:ce},r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q,null))),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.f4fb8696.chunk.js.map